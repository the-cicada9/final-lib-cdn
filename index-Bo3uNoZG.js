(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function u(t){return new Promise((e,n)=>{const s=document.createElement("script");s.src=t,s.onload=()=>e(t),s.onerror=o=>n(`Error loading script: ${t}`),document.body.appendChild(s)})}async function w(){try{console.log("Loading html2canvas..."),await u("https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"),console.log("html2canvas loaded!"),console.log("Loading Fabric.js..."),await u("https://cdn.jsdelivr.net/npm/fabric@6.4.3/dist/index.js"),console.log("Fabric.js loaded!"),console.log("Loading JSZip..."),await u("https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"),console.log("JSZip loaded!"),C.runSdk()}catch(t){console.error("Error loading scripts:",t)}}w();const C={runSdk(){A(),S()}};let d="",h="";const I="https://bmrtapplicationdev.appskeeper.in/v1/sessions/session",T={appToken:"0f4365b8-a41d-41c3-80d9-b23bc6e2594f",deviceToken:"qwe123"};fetch(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}).then(t=>t.json()).then(t=>{const e=t.result.token;console.log(e,">>>accesstoken");const n="https://bmrtapplicationdev.appskeeper.in/v1/issues",s={appInfo:{minSdk:"21",targetSdk:"30",isDebugMode:!0,debuggerAttach:!1,packageId:"com.example.app",locale:"en_US",buildFlavour:"release",versionCode:"123",versionName:"1.2.3"},deviceInfo:{name:"Pixel 4a",manufacturer:"Google",model:"Pixel 4a",deviceId:"12345abcdef",deviceVersion:"Android 12"},platform:{isRooted:!1,os:"iOS"},dimensions:{width:"1080",height:"2340",scale:"3.0",dpi_x:"400",dpi_y:"400",density:"2.75",density_dpi:"420"},type:"bug",email:"user@example.com",accessToken:e,appToken:"0f4365b8-a41d-41c3-80d9-b23bc6e2594f",video:"https://example.com/video.mp4",screenshot:"https://example.com/screenshot.png",shortSummary:"App crashes when clicking the button",description:"The app crashes immediately after clicking the button on the main screen.",trackingSdkVersion:"2.1.0",totalDuration:"5m30s",createdAt:"2024-11-08T10:30:00.000Z",uploadedAt:"2024-11-08T10:33:12.624Z"};return fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)})}).then(t=>t.json()).then(t=>{console.log("Issue created successfully",t),d=t.result.url,h=t.result.id,console.log(d)}).catch(t=>{console.error("Error:",t)});function S(){const t=document.getElementById("def-camera"),e=document.getElementById("def-img"),n=document.getElementById("def-ui");t.addEventListener("click",function(){t.textContent==="Capture"?(t.style.visibility="hidden",n.style.backgroundColor="white",html2canvas(document.querySelector("body"),{allowTaint:!0,useCORS:!0,height:window.innerHeight,width:window.innerWidth,x:window.scrollX,y:window.scrollY}).then(s=>{const o=s.toDataURL(),i=g(o);e.src=o,e.style.opacity="1",t.style.visibility="visible",n.style.backgroundColor="gray",sendToAPI(i,"")}),t.textContent="Cancel"):t.textContent==="Cancel"&&(e.style.opacity="0",t.textContent="Capture")}),e.addEventListener("click",function(){k(e.src)})}function k(t){const e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0, 0, 0, 0.8)",e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="1000";const n=document.createElement("img");n.src=t,n.style.maxWidth="90%",n.style.maxHeight="80%",n.style.objectFit="contain",n.style.position="absolute";const s=document.createElement("canvas");s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.zIndex="10",e.appendChild(n),e.appendChild(s);const o=document.createElement("button");o.textContent="Submit",o.style.position="absolute",o.style.padding="10px",o.style.backgroundColor="#fff",o.style.border="none",o.style.cursor="pointer",o.style.top="20px",o.style.right="20px",o.style.borderRadius="5px",o.style.zIndex="20",e.appendChild(o);const i=document.createElement("textarea");i.style.width="60%",i.style.marginTop="90px",i.style.padding="10px",i.style.fontSize="14px",i.style.borderRadius="5px",i.style.border="1px solid #ccc",i.placeholder="Write description...",e.appendChild(i),document.getElementById("canvas-container").appendChild(e);const r=new fabric.Canvas(s);r.isDrawingMode=!0,r.freeDrawingBrush=new fabric.PencilBrush(r),r.freeDrawingBrush.width=5,r.freeDrawingBrush.color="#000000",n.onload=function(){r.setWidth(n.width),r.setHeight(n.height),r.renderAll()},r.on("path:created",function(){const p=r.toDataURL();console.log(p,">>>new")}),o.addEventListener("click",function(){o.style.display="none",html2canvas(e).then(function(p){const f=p.toDataURL("image/png"),b=g(f),v=i.value;console.log(v,">>>desc");const x={metadata:{batteryInfo:[{isCharging:!0,lowPowerMode:!0,batteryPercentage:"75%",capturedAt:"2024-11-08T10:33:12.624Z",duration:"15m"}],network:[{type:"Wi-Fi",status:"connected",rssi:"-60dBm",ssid:"MyWiFiNetwork",bssid:"00:14:22:01:23:45",mcc:"310",mnc:"260",name:"Home Wi-Fi",networkCountryCode:"US",simCountryCode:"US",phoneType:"Smartphone",capturedAt:"2024-11-08T10:33:15.000Z",duration:"5m"}],deviceOrientation:[{value:"portrait",capturedAt:"2024-11-08T10:33:20.000Z",duration:"10m"}],applicationState:[{value:"foreground",capturedAt:"2024-11-08T10:33:25.000Z",duration:"7m"}],multiWindow:[{value:!1,capturedAt:"2024-11-08T10:33:30.000Z",duration:"5m"}],topView:[{value:"com.example.app.MainActivity",capturedAt:"2024-11-08T10:33:35.000Z",duration:"6m"}],cpuUtilization:[{value:"18%",capturedAt:"2024-11-08T10:33:40.000Z",duration:"5m"}],flash:[{capturedAt:"2024-11-08T10:33:45.000Z",memory:"30MB",unit:"MB"}],memory:[{capturedAt:"2024-11-08T10:33:50.000Z",memory:"1.8GB",unit:"GB"}],bluetooth:[{isConnected:!0,name:"Bluetooth Speaker",capturedAt:"2024-11-08T10:33:12.624Z",duration:"15m"}]}};var l=new JSZip;l.folder("BMRTLogs"),l.folder("BMRTLogs").file("snapshot.jpeg",b),l.folder("BMRTLogs").file("meta.json",JSON.stringify(x)),console.log(l,">>> zip object"),console.log(d,"url_for_zip_file"),l.generateAsync({type:"blob"}).then(function(y){console.log(y,">>> generated zip content");const m=new File([y],`issue_${h}.zip`,{type:"application/zip"});console.log(m,">>> created zip file"),fetch(d,{method:"PUT",body:m}).then(a=>a.json()).then(a=>{console.log("API Response:",a),o.style.display="block"}).catch(a=>{console.error("Error uploading ZIP:",a),o.style.display="block"})})})})}function A(){const t=document.createElement("div"),e=document.createElement("button"),n=document.createElement("img"),s=document.createElement("div");n.id="def-img",e.id="def-camera",t.id="def-ui",s.id="canvas-container",e.textContent="Capture",e.style.color="black",e.style.fontSize="16px",e.style.fontWeight="400",e.style.backgroundColor="white",e.style.width="88%",e.style.height="72%",e.style.position="relative",e.style.top="50%",e.style.left="50%",e.style.borderRadius="6px",e.style.border="none",e.style.transform="translate(-50%, -50%)",e.style.cursor="pointer",e.style.zIndex="100",t.style.position="fixed",t.style.bottom="16px",t.style.right="16px",t.style.width="130px",t.style.height="60px",t.style.backgroundColor="gray",t.style.borderRadius="10px",t.style.zIndex="100",n.style.position="fixed",n.style.width="24vw",n.style.height="30vh",n.style.objectFit="contain",n.style.right="16px",n.style.bottom="80px",n.style.borderRadius="12px",n.style.opacity="0",n.style.background="gray",n.style.zIndex="100",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.zIndex="10",document.body.appendChild(s),document.body.appendChild(t),t.appendChild(e),document.body.appendChild(n)}function g(t){const e=atob(t.split(",")[1]),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const s=t.split(";")[0].split(":")[1];return new Blob([n],{type:s})}
